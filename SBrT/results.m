clear; close all; clc;

% symbols per mensagem: 16 symbols;

general_Theoretical_error = @(range, M) 2*qfunc(sqrt(2*db2pow(range))*sin(pi/M));

EbN0dB = -10:0.5:15;
SISO_AWGN_BPSK = [0.200000000000000	0.222958057395144	0.200000000000000	0.221238938053097	0.161787365177196	0.152941176470588	0.136246786632391	0.126550868486352	0.104663212435233	0.0962962962962963	0.0721357850070721	0.0798722044728435	0.0496592015579357	0.0308788598574822	0.0293178519593614	0.0186428038777032	0.00704906703524534	0.00554649265905383	0.00205170291341814	0.000814942791016071	0.000412425557186928	0.000166701118231101	4.89527058118610e-05	1.55970714938563e-05	3.16149591364007e-06	6.05569690897851e-7	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0   0];

SISO_AWGN_QPSK = [
    ];

SISO_AWGN_8PSK = [
    ];

SISO_AWGN_16PSK = [
    ];

SISO_AWGN_32PSK = [
    ];

SISO_AWGN_64PSK = [
    ];

semilogy(EbN0dB, SISO_AWGN_BPSK, 'Color', 'Red'); 
hold on
semilogy(-10:0.5:15, general_Theoretical_error(-10:0.5:15,2), 'Color', 'Blue')
grid on
hold off

xlabel("Eb/N0");
ylabel("BER");
ylim([1e-6 1e0])

title("Bit Error Rate x Eb/N0");
legend({'BPSK-LSKF', 'Theoretical error for BPSK'})