clear; close all; clc;

% symbols per mensagem: 16 symbols;

general_Theoretical_error = @(range, M) 2*qfunc(sqrt(2*db2pow(range))*sin(pi/M));

EbN0dB = -10:0.5:15;

% 16 símbolos => CR = 4
SISO_AWGN_BPSK = [0.200000000000000	0.222958057395144	0.200000000000000	0.221238938053097	0.161787365177196	0.152941176470588	0.136246786632391	0.126550868486352	0.104663212435233	0.0962962962962963	0.0721357850070721	0.0798722044728435	0.0496592015579357	0.0308788598574822	0.0293178519593614	0.0186428038777032	0.00704906703524534	0.00554649265905383	0.00205170291341814	0.000814942791016071	0.000412425557186928	0.000166701118231101	4.89527058118610e-05	1.55970714938563e-05	3.16149591364007e-06	6.05569690897851e-7	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0   0];

% 16 símbolos => CR = 4
SISO_AWGN_QPSK = [0.226373626373626	0.221987315010571	0.224669603524229	0.182481751824818	0.203187250996016	0.178761061946903	0.175257731958763	0.139310344827586	0.131782945736434	0.137466307277628	0.106514994829369	0.105485232067511	0.0733137829912024	0.0656167979002625	0.0418760469011725	0.0323415265200518	0.0304506699147381	0.0233863423760524	0.0196386488609584	0.0158528852251110	0.0106791969243913	0.00685119210742669	0.00590332573499328	0.00368025909023995	0.00204498977505113	0.00110204981265153	0.000673618408643871	0.000362860501908646	0.000170219719614078	0.000114773139412637	4.13980622395027e-05	1.58228913999765e-05	5.8095004387334731331518910156308e-6	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0];

% 6 símbolos => CR = 4.5
SISO_AWGN_8PSK = [0.284294234592445	0.284621920135939	0.281892424669107	0.262359403609731	0.252077562326870	0.245949926362297	0.227035608981629	0.229357798165138	0.210327455919395	0.188608072425500	0.177556818181818	0.164744645799012	0.141284403669725	0.123213405618531	0.112790435371081	0.0948766603415560	0.0820693613183570	0.0685400959561343	0.0561419267909275	0.0469395418700714	0.0343927160281739	0.0299401197604790	0.0220760298467924	0.0177405620210048	0.0126122490162446	0.00906651193152970	0.00686646407968117	0.00474108912299333	0.00314847582285416	0.00201201575810742	0.00123166967604624	0.000750052503675257	0.000401031774549561	0.000237181524507967	0.000109897500798955	4.49439e-5	0 0	0	0	0	0	0	0	0	0	0	0	0	0	0];

SISO_AWGN_16PSK = [
    ];

t = tiledlayout(2,2);
% Scatterploting
title('AWGN M-PSK BER')
nexttile
semilogy(EbN0dB, SISO_AWGN_BPSK, 'Color', 'Red'); 
hold on
semilogy(EbN0dB, general_Theoretical_error(EbN0dB,2), 'Color', 'Blue')
xlabel("Eb/N0");
ylabel("BER");

ylim([1e-5 1e0])
xlim([EbN0dB(1) 25])

legend({'BPSK-LSKF-AWGN', 'Theoretical error for BPSK-AWGN'})
grid on
hold off


nexttile
semilogy(EbN0dB, SISO_AWGN_QPSK, 'Color', 'Red');
hold on
semilogy(EbN0dB, general_Theoretical_error(EbN0dB,4), 'Color', 'Blue')
xlabel("Eb/N0");
ylabel("BER");

ylim([1e-5 1e0])
xlim([EbN0dB(1) 25])

legend({'QPSK-LSKF-AWGN', 'Theoretical error for QPSK-AWGN'})
grid on
hold off


nexttile
semilogy(EbN0dB, SISO_AWGN_8PSK, 'Color', 'Red')
hold on
semilogy(-10:0.5:25, general_Theoretical_error(-10:0.5:25,8), 'Color', 'Blue')
xlabel("Eb/N0");
ylabel("BER");

ylim([1e-4 1e0])
xlim([EbN0dB(1) 25])

legend({'8PSK-LSKF-AWGN', 'Theoretical error for 8PSK-AWGN'})
grid on
hold off

nexttile





